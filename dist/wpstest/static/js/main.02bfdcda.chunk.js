(this.webpackJsonpwpstest=this.webpackJsonpwpstest||[]).push([[0],{23:function(e,t,n){},34:function(e,t,n){e.exports=n(62)},62:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(15),s=n.n(i),c=n(33),r=n(2),p=n(8),l=n(9),u=n(12),m=n(11);var d={WPS_Enum:{msoCTPDockPositionLeft:0,msoCTPDockPositionRight:2},GetUrlPath:function(){var e=document.location.toString();return-1!==(e=decodeURI(e)).indexOf("/")&&(e=e.substring(0,e.lastIndexOf("/"))),e}};var g=function(e){var t="string"==typeof e?JSON.parse(e):e;return alert("\u4ece\u4e1a\u52a1\u7cfb\u7edf\u4f20\u8fc7\u6765\u7684\u53c2\u6570\u4e3a\uff1a"+JSON.stringify(t)),{"wps\u52a0\u8f7d\u9879\u9879\u8fd4\u56de":t.filepath+", \u8fd9\u4e2a\u5730\u5740\u7ed9\u7684\u4e0d\u6b63\u786e"}},b=function(e){var t="string"==typeof e?JSON.parse(e):e;switch(t.Index){case"getDocumentName":var n="";return wps.WpsApplication().ActiveDocument&&(n=wps.WpsApplication().ActiveDocument.Name),{"\u5f53\u524d\u6253\u5f00\u7684\u6587\u4ef6\u540d\u4e3a":n};case"newDocument":return{"\u64cd\u4f5c\u7ed3\u679c":"\u65b0\u5efa\u6587\u6863\u6210\u529f\uff0c\u6587\u6863\u540d\u4e3a\uff1a"+wps.WpsApplication().Documents.Add().Name};case"OpenFile":var a=t.filepath;return wps.WpsApplication().Documents.OpenFromUrl(a),{"\u64cd\u4f5c\u7ed3\u679c":"\u6253\u5f00\u6587\u4ef6\u6210\u529f"}}return{"\u5176\u5b83xxx":""}},v=0,w={OnAddinLoad:function(e){return"object"!=typeof wps.ribbonUI&&(wps.ribbonUI=e),"object"!=typeof wps.Enum&&(wps.Enum=d.WPS_Enum),window.openOfficeFileFromSystemDemo=g,window.InvokeFromSystemDemo=b,wps.PluginStorage.setItem("EnableFlag",!1),wps.PluginStorage.setItem("ApiEventFlag",!1),!0},OnAction:function(e){switch(e.Id){case"btnShowMsg":var t=wps.WpsApplication().ActiveDocument;if(!t)return void alert("\u5f53\u524d\u6ca1\u6709\u6253\u5f00\u4efb\u4f55\u6587\u6863");alert(t.Name);break;case"btnIsEnbable":var n=wps.PluginStorage.getItem("EnableFlag");wps.PluginStorage.setItem("EnableFlag",!n),wps.ribbonUI.InvalidateControl("btnIsEnbable"),wps.ribbonUI.InvalidateControl("btnShowDialog"),wps.ribbonUI.InvalidateControl("btnShowTaskPane");break;case"btnShowDialog":wps.ShowDialog(d.GetUrlPath()+"dialog","\u8fd9\u662f\u4e00\u4e2a\u5bf9\u8bdd\u6846\u7f51\u9875",400*window.devicePixelRatio,400*window.devicePixelRatio,!1);break;case"btnShowTaskPane":var a=wps.PluginStorage.getItem("taskpane_id");if(a){var o=wps.GetTaskPane(a);o.Visible=!o.Visible}else{var i=wps.CreateTaskPane(d.GetUrlPath()+"taskpane"),s=i.ID;wps.PluginStorage.setItem("taskpane_id",s),i.Visible=!0}break;case"btnApiEvent":var c=!wps.PluginStorage.getItem("ApiEventFlag");wps.PluginStorage.setItem("ApiEventFlag",c),c?wps.ApiEvent.AddApiEventListener("DocumentNew","ribbon.OnNewDocumentApiEvent"):wps.ApiEvent.RemoveApiEventListener("DocumentNew","ribbon.OnNewDocumentApiEvent"),wps.ribbonUI.InvalidateControl("btnApiEvent");break;case"btnWebNotify":var r=new Date,p=r.getHours()+":"+r.getMinutes()+":"+r.getSeconds();wps.OAAssist.WebNotify("\u8fd9\u884c\u5185\u5bb9\u7531wps\u52a0\u8f7d\u9879\u4e3b\u52a8\u9001\u8fbe\u7ed9\u4e1a\u52a1\u7cfb\u7edf\uff0c\u53ef\u4ee5\u4efb\u610f\u81ea\u5b9a\u4e49, \u6bd4\u5982\u65f6\u95f4\u503c:"+p+"\uff0c\u6b21\u6570\uff1a"+ ++v,!0)}return!0},GetImage:function(e){switch(e.Id){case"btnShowMsg":return"images/1.svg";case"btnShowDialog":return"images/2.svg";case"btnShowTaskPane":return"images/3.svg"}return"images/newFromTemp.svg"},OnGetEnabled:function(e){switch(e.Id){case"btnShowMsg":return!0;case"btnShowDialog":return wps.PluginStorage.getItem("EnableFlag");case"btnShowTaskPane":return wps.PluginStorage.getItem("EnableFlag")}return!0},OnGetVisible:function(e){var t=e.Id;return console.log(t),!0},OnGetLabel:function(e){switch(e.Id){case"btnIsEnbable":return wps.PluginStorage.getItem("EnableFlag")?"\u6309\u94aeDisable":"\u6309\u94aeEnable";case"btnApiEvent":return wps.PluginStorage.getItem("ApiEventFlag")?"\u6e05\u9664\u65b0\u5efa\u6587\u4ef6\u4e8b\u4ef6":"\u6ce8\u518c\u65b0\u5efa\u6587\u4ef6\u4e8b\u4ef6"}return""},OnNewDocumentApiEvent:function(e){alert("\u65b0\u5efa\u6587\u4ef6\u4e8b\u4ef6\u54cd\u5e94\uff0c\u53d6\u6587\u4ef6\u540d: "+e.Name)}},f=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).state={},console.log("init ribbon"),window.ribbon=w,a}return Object(l.a)(n,[{key:"render",value:function(){return o.a.createElement("div",null,"this is index.html")}}]),n}(a.Component),k=n(10);n(23);var h=n(16),S=n.n(h),E=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).onDocNameClick=function(){(0,a.props.getDocName)()},a.onCreateTaskpane=function(){(0,a.props.createTaskpane)()},a.onCreateDoc=function(){(0,a.props.newDoc)()},a.onAddString=function(){(0,a.props.addString)()},a.onCloseDoc=function(){(0,a.props.closeDoc)()},a.onOpenWeb=function(){(0,a.props.openWeb)()},a.state={},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;S.a.get("/.debugTemp/NotifyDemoUrl").then((function(t){(0,e.props.setDemoSpan)(t.data)}))}},{key:"render",value:function(){var e=this.props,t=e.docName,n=e.demoSpan;return o.a.createElement("div",null,o.a.createElement("div",{className:"divItem"},"\u8fd9\u662f\u4e00\u4e2a\u7f51\u9875\uff0c\u6309",o.a.createElement("span",{className:"debug"},'"F12"'),"\u53ef\u4ee5\u6253\u5f00\u8c03\u8bd5\u5668\u3002"),o.a.createElement("div",{className:"divItem"},"\u8fd9\u4e2a\u793a\u4f8b\u5c55\u793a\u4e86wps\u52a0\u8f7d\u9879\u7684\u76f8\u5173\u57fa\u7840\u80fd\u529b\uff0c\u4e0eB/S\u4e1a\u52a1\u7cfb\u7edf\u7684\u4ea4\u4e92\uff0c\u8bf7\u7528\u6d4f\u89c8\u5668\u6253\u5f00\uff1a",o.a.createElement("span",{className:"docs",onClick:this.onOpenWeb},n)),o.a.createElement("div",{className:"divItem"},"\u5f00\u53d1\u6587\u6863: ",o.a.createElement("span",{className:"docs"},"https://open.wps.cn/docs/office")),o.a.createElement("div",null,o.a.createElement("button",{onClick:this.onDocNameClick},"\u53d6\u6587\u4ef6\u540d"),o.a.createElement("button",{onClick:this.onCreateTaskpane},"\u521b\u5efa\u4efb\u52a1\u7a97\u683c"),o.a.createElement("button",{onClick:this.onCreateDoc},"\u65b0\u5efa\u6587\u4ef6"),o.a.createElement("button",{onClick:this.onAddString},"\u6587\u6863\u5f00\u5934\u6dfb\u52a0\u5b57\u7b26\u4e32"),o.a.createElement("button",{onClick:this.onCloseDoc},"\u5173\u95ed\u6587\u4ef6")),o.a.createElement("hr",null),o.a.createElement("div",null,"\u6587\u6863\u6587\u4ef6\u540d\u4e3a\uff1a",o.a.createElement("span",null,t)))}}]),n}(a.Component),D=Object(k.b)((function(e){return{docName:e.dialog.get("docName"),demoSpan:e.dialog.get("demoSpan")}}),{getDocName:function(e){return{type:"getDocName",data:e}},createTaskpane:function(e){return{type:"createTaskpane",data:e}},newDoc:function(e){return{type:"newDoc",data:e}},addString:function(e){return{type:"addString",data:e}},closeDoc:function(e){return{type:"closeDoc",data:e}},setDemoSpan:function(e){return{type:"setDemoSpan",data:e}},openWeb:function(e){return{type:"openWeb",data:e}}})(E);var P=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(p.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).onDockLeft=function(){(0,e.props.dockLeft)()},e.onDockRight=function(){(0,e.props.dockRight)()},e.onHideTaskPane=function(){(0,e.props.hideTaskPane)()},e.onAddString=function(){(0,e.props.addString)()},e.onGetDocName=function(){(0,e.props.getDocName)()},e.onOpenWeb=function(){(0,e.props.openWeb)()},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;S.a.get("/.debugTemp/NotifyDemoUrl").then((function(t){(0,e.props.setDemoSpan)(t.data)}))}},{key:"render",value:function(){var e=this.props,t=e.docName,n=e.demoSpan;return o.a.createElement("div",{className:"global"},o.a.createElement("div",{className:"divItem"},"\u8fd9\u662f\u4e00\u4e2a\u7f51\u9875\uff0c\u6309",o.a.createElement("span",{className:"debug"},'"F12"'),"\u53ef\u4ee5\u6253\u5f00\u8c03\u8bd5\u5668\u3002"),o.a.createElement("div",{className:"divItem"},"\u8fd9\u4e2a\u793a\u4f8b\u5c55\u793a\u4e86wps\u52a0\u8f7d\u9879\u7684\u76f8\u5173\u57fa\u7840\u80fd\u529b\uff0c\u4e0eB/S\u4e1a\u52a1\u7cfb\u7edf\u7684\u4ea4\u4e92\uff0c\u8bf7\u7528\u6d4f\u89c8\u5668\u6253\u5f00\uff1a",o.a.createElement("span",{className:"docs",onClick:this.onOpenWeb},n)),o.a.createElement("div",{className:"divItem"},"\u5f00\u53d1\u6587\u6863:"," ",o.a.createElement("span",{className:"docs"},"https://open.wps.cn/docs/office")),o.a.createElement("hr",null),o.a.createElement("div",{className:"divItem"},o.a.createElement("button",{onClick:this.onDockLeft},"\u505c\u9760\u5de6\u8fb9"),o.a.createElement("button",{onClick:this.onDockRight},"\u505c\u9760\u53f3\u8fb9"),o.a.createElement("button",{onClick:this.onHideTaskPane},"\u9690\u85cfTaskPane"),o.a.createElement("button",{onClick:this.onAddString}," \u6587\u6863\u5f00\u5934\u6dfb\u52a0\u5b57\u7b26\u4e32"),o.a.createElement("button",{onClick:this.onGetDocName}," \u53d6\u6587\u4ef6\u540d")),o.a.createElement("hr",null),o.a.createElement("div",{className:"divItem"},"\u6587\u6863\u6587\u4ef6\u540d\u4e3a\uff1a",o.a.createElement("span",null,t)))}}]),n}(a.Component),N=Object(k.b)((function(e){return{docName:e.dialog.get("docName"),demoSpan:e.dialog.get("demoSpan")}}),{dockLeft:function(e){return{type:"dockLeft",data:e}},dockRight:function(e){return{type:"dockRight",data:e}},hideTaskPane:function(e){return{type:"hideTaskPane",data:e}},addString:function(e){return{type:"addString",data:e}},getDocName:function(e){return{type:"getDocName",data:e}},setDemoSpan:function(e){return{type:"setDemoSpan",data:e}},openWeb:function(e){return{type:"openWeb",data:e}}})(P),A=n(18),I=n(17),O=I.a({docName:null,demoSpan:"waiting..."}),C=I.a({docName:null,demoSpan:"waiting..."}),T=Object(A.a)({dialog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"getDocName":var n=wps.WpsApplication().ActiveDocument.Name,a=e.set("docName",n);return a;case"newDoc":wps.WpsApplication().Documents.Add();break;case"createTaskpane":var o=wps.PluginStorage.getItem("taskpane_id");if(o){var i=wps.GetTaskPane(o);i.Visible=!0}else{var s=wps.CreateTaskPane(d.GetUrlPath()+"taskpane"),c=s.ID;wps.PluginStorage.setItem("taskpane_id",c),s.Visible=!0}break;case"addString":var r=wps.WpsApplication().ActiveDocument;if(r){r.Range(0,0).Text="Hello, wps\u52a0\u8f7d\u9879!";var p=wps.WpsApplication().Selection.Range;p&&p.Select()}break;case"closeDoc":if(wps.WpsApplication().Documents.Count<2){alert("\u5f53\u524d\u53ea\u6709\u4e00\u4e2a\u6587\u6863\uff0c\u522b\u5173\u4e86\u3002");break}var l=wps.WpsApplication().ActiveDocument;l&&l.Close();break;case"setDemoSpan":var u=e.set("demoSpan",t.data);return u;case"openWeb":var m=e.get("demoSpan");wps.OAAssist.ShellExecute(m)}return e},taskpane:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"dockLeft":var n=wps.PluginStorage.getItem("taskpane_id");if(n){var a,o=wps.GetTaskPane(n);a=wps.Enum?wps.Enum.msoCTPDockPositionLeft:d.WPS_Enum.msoCTPDockPositionLeft,o.DockPosition=a}break;case"dockRight":var i=wps.PluginStorage.getItem("taskpane_id");if(i){var s,c=wps.GetTaskPane(i);s=wps.Enum?wps.Enum.msoCTPDockPositionRight:d.WPS_Enum.msoCTPDockPositionRight,c.DockPosition=s}break;case"hideTaskPane":var r=wps.PluginStorage.getItem("taskpane_id");if(r){var p=wps.GetTaskPane(r);p.Visible=!1}break;case"addString":var l=wps.WpsApplication().ActiveDocument;if(l){l.Range(0,0).Text="Hello, wps\u52a0\u8f7d\u9879!";var u=wps.WpsApplication().Selection.Range;u&&u.Select()}break;case"getDocName":var m=wps.WpsApplication().ActiveDocument.Name,g=e.set("docName",m);return g;case"setDemoSpan":var b=e.set("DemoSpan",t.data);return b;case"openWeb":var v=e.get("demoSpan");wps.OAAssist.ShellExecute(v)}return e}}),y=Object(A.b)(T,window.STATE_FROM_SERVER);s.a.render(o.a.createElement(k.a,{store:y},o.a.createElement(c.a,null,o.a.createElement(r.c,null,o.a.createElement(r.a,{path:"/",exact:!0,component:f}),o.a.createElement(r.a,{path:"/dialog",exact:!0,component:D}),o.a.createElement(r.a,{path:"/taskpane",exact:!0,component:N})))),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.02bfdcda.chunk.js.map